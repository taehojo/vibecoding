<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µê° AI ë‹¤ì´ì–´ë¦¬ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            box-sizing: border-box;
        }

        textarea:focus {
            outline: none;
            border-color: #4CAF50;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #45a049;
        }

        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .result {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
        }

        .emotion-display {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .emotion-tag {
            background-color: #4CAF50;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            margin-right: 15px;
            font-weight: bold;
        }

        .emotion-score {
            background-color: #2196F3;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 14px;
        }

        .empathy-message {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            font-style: italic;
            color: #555;
        }

        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
        }

        .error {
            background-color: #ffebee;
            border-left-color: #f44336;
            color: #c62828;
        }

        .test-examples {
            margin-top: 30px;
            padding: 20px;
            background-color: #e8f5e8;
            border-radius: 8px;
        }

        .test-examples h3 {
            margin-top: 0;
            color: #2e7d32;
        }

        .example-btn {
            background-color: #81C784;
            margin: 5px;
            padding: 8px 16px;
            font-size: 14px;
        }

        .example-btn:hover {
            background-color: #66BB6A;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¤— ê³µê° AI ë‹¤ì´ì–´ë¦¬</h1>

        <div class="form-group">
            <label for="diaryText">ì˜¤ëŠ˜ì˜ ì¼ê¸°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:</label>
            <textarea
                id="diaryText"
                placeholder="ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë–¤ ì¼ì´ ìˆì—ˆë‚˜ìš”? ì–´ë–¤ ê°ì •ì„ ëŠê¼ˆë‚˜ìš”? ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”..."
            ></textarea>
        </div>

        <button onclick="analyzeDiary()" id="analyzeBtn">ê°ì • ë¶„ì„í•˜ê¸°</button>

        <div id="result" style="display: none;"></div>

        <div class="test-examples">
            <h3>ğŸ“ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ</h3>
            <p>ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ë‹¤ì–‘í•œ ê°ì •ì˜ ì¼ê¸° ì˜ˆì‹œë¥¼ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”:</p>

            <button class="example-btn" onclick="setExampleText('joy')">ê¸°ì¨</button>
            <button class="example-btn" onclick="setExampleText('sadness')">ìŠ¬í””</button>
            <button class="example-btn" onclick="setExampleText('anger')">ë¶„ë…¸</button>
            <button class="example-btn" onclick="setExampleText('fear')">ë‘ë ¤ì›€</button>
            <button class="example-btn" onclick="setExampleText('mixed')">ë³µí•©ê°ì •</button>
        </div>
    </div>

    <script src="backend.js"></script>
    <script>
        // ì˜ˆì‹œ í…ìŠ¤íŠ¸
        const examples = {
            joy: "ì˜¤ëŠ˜ ì •ë§ ì¢‹ì€ í•˜ë£¨ì˜€ë‹¤! ì•„ì¹¨ì— ì¼ì–´ë‚˜ìë§ˆì ì¹œêµ¬ì—ê²Œì„œ ì¢‹ì€ ì†Œì‹ì„ ë“¤ì—ˆê³ , ì˜¤í›„ì—ëŠ” ì˜¤ë«ë™ì•ˆ ì¤€ë¹„í–ˆë˜ í”„ë¡œì íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆë‹¤ëŠ” ì—°ë½ì„ ë°›ì•˜ë‹¤. ì €ë…ì—ëŠ” ê°€ì¡±ë“¤ê³¼ í•¨ê»˜ ë§›ìˆëŠ” ì €ë…ì„ ë¨¹ìœ¼ë©° ì¦ê±°ìš´ ì‹œê°„ì„ ë³´ëƒˆë‹¤. ì´ëŸ° í–‰ë³µí•œ ìˆœê°„ë“¤ì´ ê³„ì†ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë‹¤.",

            sadness: "ì˜¤ëŠ˜ì€ ì •ë§ í˜ë“  í•˜ë£¨ì˜€ë‹¤. ì•„ì¹¨ë¶€í„° ë¹„ê°€ ë‚´ë ¤ì„œ ê¸°ë¶„ì´ ìš°ìš¸í–ˆëŠ”ë°, íšŒì‚¬ì—ì„œë„ ì¢‹ì§€ ì•Šì€ ì¼ì´ ìˆì—ˆë‹¤. ì˜¤ë«ë™ì•ˆ í•¨ê»˜ ì¼í–ˆë˜ ë™ë£Œê°€ í‡´ì‚¬í•œë‹¤ëŠ” ì†Œì‹ì„ ë“¤ì—ˆê³ , ë‚˜ í˜¼ì ë‚¨ê²¨ì§„ ê²ƒ ê°™ì€ ì™¸ë¡œì›€ì„ ëŠê¼ˆë‹¤. ì§‘ì— ëŒì•„ì™€ì„œë„ ê³„ì† ìŠ¬í”ˆ ê¸°ë¶„ì´ ë“¤ì–´ì„œ ëˆˆë¬¼ì´ ë‚¬ë‹¤.",

            anger: "ì˜¤ëŠ˜ ì •ë§ í™”ê°€ ë‚¬ë‹¤. ì§€í•˜ì² ì—ì„œ ìƒˆì¹˜ê¸°ë¥¼ í•˜ëŠ” ì‚¬ëŒ ë•Œë¬¸ì— ê¸°ë¶„ì´ ìƒí–ˆëŠ”ë°, íšŒì‚¬ì—ì„œë„ ì–µìš¸í•œ ì¼ì´ ìˆì—ˆë‹¤. ë‚´ê°€ ì—´ì‹¬íˆ ì¤€ë¹„í•œ ì•„ì´ë””ì–´ë¥¼ ë‹¤ë¥¸ ì‚¬ëŒì´ ê°€ì ¸ê°€ì„œ ë°œí‘œí–ˆëŠ”ë°ë„ ì•„ë¬´ë„ ë¬¸ì œì‚¼ì§€ ì•Šì•˜ë‹¤. ì´ëŸ° ë¶ˆê³µì •í•œ ìƒí™©ì´ ì •ë§ ë‹µë‹µí•˜ê³  ë¶„í•˜ë‹¤.",

            fear: "ë‚´ì¼ ì¤‘ìš”í•œ ë©´ì ‘ì´ ìˆì–´ì„œ ë„ˆë¬´ ê¸´ì¥ë˜ê³  ë¶ˆì•ˆí•˜ë‹¤. ë°¤ìƒˆ ì¤€ë¹„ë¥¼ í–ˆì§€ë§Œ ì—¬ì „íˆ ë¶€ì¡±í•œ ê²ƒ ê°™ê³ , í˜¹ì‹œ ì‹¤ìˆ˜ë¥¼ í•˜ë©´ ì–´ë–»ê²Œ í•˜ì§€ í•˜ëŠ” ê±±ì •ì´ ê³„ì† ë“ ë‹¤. ì‹¬ì¥ì´ ë‘ê·¼ê±°ë¦¬ê³  ì†ì— ë•€ì´ ë‚œë‹¤. ì˜ í•  ìˆ˜ ìˆì„ì§€ ìì‹ ì´ ì—†ì–´ì„œ ë¬´ì„­ë‹¤.",

            mixed: "ì˜¤ëŠ˜ì€ ì •ë§ ë³µì¡í•œ í•˜ë£¨ì˜€ë‹¤. ì•„ì¹¨ì—ëŠ” ì¢‹ì€ ì†Œì‹ì„ ë“¤ì–´ì„œ ê¸°ë»¤ëŠ”ë°, ì˜¤í›„ì—ëŠ” ì¹œêµ¬ì™€ ì‘ì€ ë‹¤íˆ¼ì´ ìˆì–´ì„œ ì†ìƒí–ˆë‹¤. ì €ë…ì—ëŠ” í˜¼ì ì‹œê°„ì„ ë³´ë‚´ë©´ì„œ ì—¬ëŸ¬ ìƒê°ì´ ë“¤ì—ˆë‹¤. ê¸°ì˜ê¸°ë„ í•˜ê³  ìŠ¬í”„ê¸°ë„ í•˜ê³ , ë•Œë¡œëŠ” í™”ê°€ ë‚˜ê¸°ë„ í–ˆë‹¤. ì¸ìƒì´ ì°¸ ë³µì¡í•˜ë‹¤ëŠ” ìƒê°ì´ ë“ ë‹¤."
        };

        function setExampleText(emotion) {
            document.getElementById('diaryText').value = examples[emotion];
        }

        async function analyzeDiary() {
            const diaryText = document.getElementById('diaryText').value.trim();
            const resultDiv = document.getElementById('result');
            const analyzeBtn = document.getElementById('analyzeBtn');

            if (!diaryText) {
                alert('ì¼ê¸° ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë¡œë”© ìƒíƒœ
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'ë¶„ì„ ì¤‘...';
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="loading">AIê°€ ë‹¹ì‹ ì˜ ê°ì •ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.</div>';

            try {
                console.log('ì¼ê¸° ë¶„ì„ ì‹œì‘:', diaryText);
                const result = await analyzeDiaryEntry(diaryText);
                console.log('ë¶„ì„ ê²°ê³¼:', result);

                // ê²°ê³¼ í‘œì‹œ
                resultDiv.className = 'result';
                resultDiv.innerHTML = `
                    <div class="emotion-display">
                        <span class="emotion-tag">${result.emotionKorean || result.emotion}</span>
                        <span class="emotion-score">ê°•ë„: ${result.emotionScore}/10</span>
                    </div>
                    <div class="empathy-message">
                        ${result.empathyMessage}
                    </div>
                `;

            } catch (error) {
                console.error('ë¶„ì„ ì˜¤ë¥˜:', error);
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <strong>ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:</strong><br>
                    ${error.message}<br><br>
                    <small>ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</small>
                `;
            } finally {
                // ë²„íŠ¼ ìƒíƒœ ë³µì›
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'ê°ì • ë¶„ì„í•˜ê¸°';
            }
        }

        // ì—”í„°í‚¤ë¡œ ë¶„ì„ ì‹¤í–‰
        document.getElementById('diaryText').addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.key === 'Enter') {
                analyzeDiary();
            }
        });

        // í˜ì´ì§€ ë¡œë“œì‹œ ì—°ê²° í…ŒìŠ¤íŠ¸
        window.addEventListener('load', async function() {
            console.log('ê³µê° AI ë‹¤ì´ì–´ë¦¬ í˜ì´ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');

            // ë°±ì—”ë“œ ì—°ê²° í…ŒìŠ¤íŠ¸
            try {
                const isConnected = await empathyDiary.testConnection();
                if (isConnected) {
                    console.log('âœ… API ì—°ê²° ì„±ê³µ');
                } else {
                    console.log('âš ï¸ API ì—°ê²° ì‹¤íŒ¨ - ëŒ€ì²´ ë¶„ì„ ëª¨ë“œë¡œ ì‘ë™');
                }
            } catch (error) {
                console.error('ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜:', error);
            }
        });
    </script>
</body>
</html>