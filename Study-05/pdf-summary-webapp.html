<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Î¨∏ÏÑú ÏöîÏïΩ ÏÑúÎπÑÏä§ - AI Í∏∞Î∞ò Ïä§ÎßàÌä∏ ÏöîÏïΩ</title>
    <meta name="description" content="AIÍ∞Ä PDF Î¨∏ÏÑúÏùò ÌïµÏã¨ ÎÇ¥Ïö©ÏùÑ Îπ†Î•¥Í≥† Ï†ïÌôïÌïòÍ≤å ÏöîÏïΩÌï¥Ï£ºÎäî ÏÑúÎπÑÏä§">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; connect-src 'self' https://openrouter.ai; img-src 'self' data:;">
    <meta name="keywords" content="PDF, ÏöîÏïΩ, AI, Î¨∏ÏÑúÏöîÏïΩ, ÌïúÍ∏Ä, ÎîîÏßÄÌÑ∏">

    <!-- Favicons -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìÑ</text></svg>">

    <!-- Preconnects for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #3b82f6;
            --primary-hover: #2563eb;
            --primary-light: #dbeafe;
            --secondary-color: #64748b;
            --accent-color: #10b981;
            --accent-hover: #059669;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --success-color: #10b981;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --background: #ffffff;
            --background-secondary: #f8fafc;
            --surface: #ffffff;
            --surface-elevated: #f1f5f9;
            --border: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --border-radius-lg: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease-out;
        }

        [data-theme="dark"] {
            --primary-color: #60a5fa;
            --primary-hover: #3b82f6;
            --primary-light: #1e3a8a;
            --secondary-color: #94a3b8;
            --accent-color: #34d399;
            --accent-hover: #10b981;
            --error-color: #f87171;
            --warning-color: #fbbf24;
            --success-color: #34d399;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --background: #0f172a;
            --background-secondary: #1e293b;
            --surface: #1e293b;
            --surface-elevated: #334155;
            --border: #334155;
            --border-light: #475569;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
            font-feature-settings: "kern" 1;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 48px;
            position: relative;
            padding: 40px 20px;
        }

        .header-decoration {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 2px;
            margin-bottom: 24px;
        }

        .header h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 24px 0 16px;
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: clamp(1rem, 2.5vw, 1.25rem);
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 32px;
            font-weight: 400;
        }

        .header-actions {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        .theme-toggle {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            font-size: 1.25rem;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .theme-toggle:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Main Content Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }
        }

        /* Card Components */
        .card {
            background: var(--surface);
            border-radius: var(--border-radius);
            padding: 32px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            opacity: 0;
            transition: var(--transition);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
        }

        .card-icon {
            font-size: 1.5rem;
            background: var(--primary-light);
            padding: 8px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        /* Upload Section */
        .upload-area {
            border: 3px dashed var(--border);
            border-radius: var(--border-radius-lg);
            padding: 48px 24px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            background: var(--background-secondary);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .upload-area:hover,
        .upload-area.drag-over {
            border-color: var(--primary-color);
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .upload-area.drag-over {
            background: linear-gradient(135deg, var(--primary-light), rgba(16, 185, 129, 0.1));
            border-color: var(--accent-color);
        }

        .upload-icon {
            font-size: 4rem;
            color: var(--text-muted);
            margin-bottom: 20px;
            transition: var(--transition);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .upload-area:hover .upload-icon,
        .upload-area.drag-over .upload-icon {
            color: var(--primary-color);
            transform: scale(1.1) translateY(-10px);
        }

        .upload-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .upload-subtext {
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 0.9rem;
        }

        .upload-button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .upload-button:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .upload-button:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        .file-input {
            display: none;
        }

        /* File Info */
        .file-info {
            display: none;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 24px;
            animation: slideIn 0.3s ease-out;
        }

        .file-info.show {
            display: block;
        }

        .file-details {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .file-icon {
            font-size: 2.5rem;
            color: var(--error-color);
            background: rgba(239, 68, 68, 0.1);
            padding: 12px;
            border-radius: var(--border-radius);
        }

        .file-meta {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 600;
            color: var(--text-primary);
            word-break: break-all;
            margin-bottom: 4px;
        }

        .file-size {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .file-actions {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.875rem;
            border-radius: var(--border-radius-sm);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .btn-danger {
            background: var(--error-color);
            color: white;
        }

        .btn-danger:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        /* Progress Bar */
        .progress-container {
            display: none;
            margin-top: 20px;
            animation: slideIn 0.3s ease-out;
        }

        .progress-container.show {
            display: block;
        }

        .progress-wrapper {
            background: var(--border-light);
            border-radius: 50px;
            padding: 4px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            height: 12px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 50px;
            width: 0%;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .progress-status {
            font-weight: 500;
        }

        .progress-percent {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* Summary Options */
        .options-group {
            margin-bottom: 32px;
        }

        .options-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .option-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .option-card {
            background: var(--surface-elevated);
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-color);
            transform: scaleX(0);
            transition: var(--transition);
        }

        .option-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .option-card:hover::before {
            transform: scaleX(1);
        }

        .option-card.selected {
            border-color: var(--primary-color);
            background: var(--primary-light);
            box-shadow: var(--shadow);
        }

        .option-card.selected::before {
            transform: scaleX(1);
        }

        .option-emoji {
            font-size: 2rem;
            margin-bottom: 8px;
            display: block;
        }

        .option-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .option-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .process-button {
            width: 100%;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
            color: white;
            border: none;
            padding: 20px;
            border-radius: var(--border-radius);
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            opacity: 0.6;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .process-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition);
        }

        .process-button.enabled {
            opacity: 1;
            pointer-events: auto;
        }

        .process-button.enabled:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .process-button.enabled:hover::before {
            left: 100%;
        }

        .process-button.processing {
            background: linear-gradient(135deg, var(--warning-color), #f97316);
            pointer-events: none;
        }

        .process-button.processing .btn-icon {
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Results Section */
        .results-section {
            display: none;
            background: var(--surface);
            border-radius: var(--border-radius-lg);
            padding: 40px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow-lg);
            position: relative;
            margin-top: 32px;
        }

        .results-section.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .results-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .results-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: var(--border-radius);
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
            text-decoration: none;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
            box-shadow: var(--shadow);
        }

        .results-content {
            background: var(--background-secondary);
            border: 1px solid var(--border);
            border-radius: var(--border-radius);
            padding: 32px;
            line-height: 1.8;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
            font-size: 1rem;
            position: relative;
        }

        .results-content::-webkit-scrollbar {
            width: 8px;
        }

        .results-content::-webkit-scrollbar-track {
            background: var(--border-light);
            border-radius: 4px;
        }

        .results-content::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        .results-content::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Loading States */
        .loading {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 400px;
        }

        .toast {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--border-radius);
            padding: 16px 20px;
            box-shadow: var(--shadow-lg);
            transform: translateX(400px);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 12px;
            position: relative;
            overflow: hidden;
        }

        .toast::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success::before {
            background: var(--success-color);
        }

        .toast.error::before {
            background: var(--error-color);
        }

        .toast.warning::before {
            background: var(--warning-color);
        }

        .toast-icon {
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: 2px;
            font-size: 0.875rem;
        }

        .toast-message {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .toast-close {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            color: var(--text-muted);
            transition: var(--transition-fast);
        }

        .toast-close:hover {
            color: var(--text-primary);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }

            .header {
                padding: 32px 16px;
                margin-bottom: 32px;
            }

            .card {
                padding: 24px;
            }

            .upload-area {
                padding: 32px 16px;
                min-height: 250px;
            }

            .upload-icon {
                font-size: 3rem;
            }

            .option-cards {
                grid-template-columns: 1fr;
            }

            .results-actions {
                width: 100%;
                justify-content: stretch;
            }

            .btn {
                flex: 1;
                justify-content: center;
            }

            .results-content {
                max-height: 400px;
                padding: 24px;
            }

            .toast-container {
                left: 16px;
                right: 16px;
                max-width: none;
            }

            .toast {
                transform: translateY(-100px);
            }

            .toast.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.75rem;
            }

            .upload-text {
                font-size: 1.125rem;
            }

            .card-title {
                font-size: 1.25rem;
            }

            .option-cards {
                gap: 12px;
            }

            .option-card {
                padding: 16px;
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        *:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* High contrast support */
        @media (prefers-contrast: high) {
            :root {
                --border: #000000;
                --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            }

            [data-theme="dark"] {
                --border: #ffffff;
                --text-secondary: #ffffff;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .upload-icon {
                animation: none;
            }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: var(--surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: var(--transition);
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            padding: 24px 32px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            transition: var(--transition-fast);
            padding: 4px;
            border-radius: 4px;
        }

        .modal-close:hover {
            color: var(--text-primary);
            background: var(--border-light);
        }

        .modal-body {
            padding: 24px 32px;
        }

        .modal-actions {
            padding: 0 32px 32px;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--border-radius-sm);
            font-size: 0.875rem;
            background: var(--background);
            color: var(--text-primary);
            transition: var(--transition-fast);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-help {
            margin-top: 6px;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .form-help a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .form-help a:hover {
            text-decoration: underline;
        }

        .security-warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning-color);
            border-radius: var(--border-radius-sm);
            padding: 12px 12px 12px 36px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 16px;
            position: relative;
        }

        .security-warning::before {
            content: 'üîí';
            position: absolute;
            left: 12px;
            top: 12px;
            font-size: 1rem;
        }

        .security-warning strong {
            color: var(--warning-color);
        }

        /* API Config Button */
        .api-config-button {
            background: var(--surface-elevated);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            font-size: 1.25rem;
        }

        .api-config-button:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .api-config-button:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Print styles */
        @media print {
            .header-actions,
            .upload-area,
            .options-group,
            .results-actions,
            .modal {
                display: none;
            }

            .results-content {
                max-height: none;
                overflow: visible;
                box-shadow: none;
                border: 1px solid #000;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-decoration"></div>
            <h1>üìÑ PDF Î¨∏ÏÑú ÏöîÏïΩ ÏÑúÎπÑÏä§</h1>
            <p>AIÍ∞Ä PDF Î¨∏ÏÑúÏùò ÌïµÏã¨ ÎÇ¥Ïö©ÏùÑ Îπ†Î•¥Í≥† Ï†ïÌôïÌïòÍ≤å Î∂ÑÏÑùÌïòÏó¨ Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å ÏöîÏïΩÌï¥ÎìúÎ¶ΩÎãàÎã§</p>
            <div class="header-actions">
                <button class="api-config-button" onclick="openApiConfigModal()" aria-label="API ÏÑ§Ï†ï" title="API ÏÑ§Ï†ï">
                    <span>‚öôÔ∏è</span>
                </button>
                <button class="theme-toggle" onclick="toggleTheme()" aria-label="Îã§ÌÅ¨Î™®Îìú ÌÜ†Í∏Ä" title="ÌÖåÎßà Î≥ÄÍ≤Ω">
                    <span id="theme-icon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Upload Section -->
            <section class="card">
                <div class="card-header">
                    <div class="card-icon">üìÅ</div>
                    <h2 class="card-title">ÌååÏùº ÏóÖÎ°úÎìú</h2>
                </div>

                <div class="upload-area"
                     onclick="document.getElementById('file-input').click()"
                     ondrop="handleDrop(event)"
                     ondragover="handleDragOver(event)"
                     ondragenter="handleDragEnter(event)"
                     ondragleave="handleDragLeave(event)"
                     role="button"
                     tabindex="0"
                     aria-label="PDF ÌååÏùº ÏóÖÎ°úÎìú ÏòÅÏó≠. ÌÅ¥Î¶≠ÌïòÍ±∞ÎÇò ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî."
                     onkeydown="handleKeyDown(event)">
                    <div class="upload-icon">üìÑ</div>
                    <div class="upload-text">PDF ÌååÏùºÏùÑ Ïó¨Í∏∞Ïóê ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî</div>
                    <div class="upload-subtext">ÎòêÎäî ÏïÑÎûò Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏó¨ ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî<br>ÏµúÎåÄ <span id="max-file-size">50MB</span>ÍπåÏßÄ ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï©ÎãàÎã§</div>
                    <button class="upload-button" type="button">
                        <span>üìÇ</span>
                        ÌååÏùº ÏÑ†ÌÉùÌïòÍ∏∞
                    </button>
                </div>

                <input type="file"
                       id="file-input"
                       class="file-input"
                       accept=".pdf"
                       onchange="handleFileSelect(event)"
                       aria-label="PDF ÌååÏùº ÏÑ†ÌÉù">

                <!-- File Info -->
                <div id="file-info" class="file-info">
                    <div class="file-details">
                        <div class="file-icon">üìÑ</div>
                        <div class="file-meta">
                            <div id="file-name" class="file-name"></div>
                            <div id="file-size" class="file-size"></div>
                        </div>
                        <div class="file-actions">
                            <button class="btn-sm btn-danger" onclick="removeFile()" aria-label="ÌååÏùº Ï†úÍ±∞">
                                üóëÔ∏è ÏÇ≠Ï†ú
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div id="progress-container" class="progress-container">
                    <div class="progress-wrapper">
                        <div id="progress-bar" class="progress-bar"></div>
                    </div>
                    <div class="progress-text">
                        <span id="progress-status" class="progress-status">ÏóÖÎ°úÎìú Ï§ë...</span>
                        <span id="progress-percent" class="progress-percent">0%</span>
                    </div>
                </div>
            </section>

            <!-- Summary Options Section -->
            <section class="card">
                <div class="card-header">
                    <div class="card-icon">‚öôÔ∏è</div>
                    <h2 class="card-title">ÏöîÏïΩ ÏÑ§Ï†ï</h2>
                </div>

                <div class="options-group">
                    <h3 class="options-title">
                        <span>üìä</span>
                        ÏöîÏïΩ ÏÉÅÏÑ∏ÎèÑ
                    </h3>
                    <div class="option-cards">
                        <div class="option-card" data-mode="simple" onclick="selectOption('simple')" role="radio" tabindex="0" aria-label="Í∞ÑÎã® ÏöîÏïΩ Î™®Îìú">
                            <span class="option-emoji">‚ö°</span>
                            <div class="option-title">Í∞ÑÎã® ÏöîÏïΩ</div>
                            <div class="option-desc">ÌïµÏã¨Îßå Îπ†Î•¥Í≤å</div>
                        </div>
                        <div class="option-card selected" data-mode="normal" onclick="selectOption('normal')" role="radio" tabindex="0" aria-label="ÏùºÎ∞ò ÏöîÏïΩ Î™®Îìú">
                            <span class="option-emoji">üìù</span>
                            <div class="option-title">ÏùºÎ∞ò ÏöîÏïΩ</div>
                            <div class="option-desc">Í∑†ÌòïÏû°Ìûå Î∂ÑÎüâ</div>
                        </div>
                        <div class="option-card" data-mode="detailed" onclick="selectOption('detailed')" role="radio" tabindex="0" aria-label="ÏÉÅÏÑ∏ ÏöîÏïΩ Î™®Îìú">
                            <span class="option-emoji">üìö</span>
                            <div class="option-title">ÏÉÅÏÑ∏ ÏöîÏïΩ</div>
                            <div class="option-desc">Î™®Îì† ÏÑ∏Î∂ÄÏÇ¨Ìï≠</div>
                        </div>
                    </div>
                </div>

                <button id="process-button"
                        class="process-button"
                        onclick="startSummary()"
                        aria-label="ÏöîÏïΩ Ï≤òÎ¶¨ ÏãúÏûë">
                    <span id="process-icon" class="btn-icon">‚ú®</span>
                    <span id="process-text">ÌååÏùºÏùÑ Î®ºÏ†Ä ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî</span>
                </button>
            </section>
        </div>

        <!-- Results Section -->
        <section id="results-section" class="results-section">
            <div class="results-header">
                <h2 class="results-title">
                    <span>üìä</span>
                    ÏöîÏïΩ Í≤∞Í≥º
                </h2>
                <div class="results-actions">
                    <button class="btn btn-outline" onclick="copyResults()" aria-label="ÏöîÏïΩ Í≤∞Í≥º Î≥µÏÇ¨ÌïòÍ∏∞" title="ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨">
                        üìã Î≥µÏÇ¨ÌïòÍ∏∞
                    </button>
                    <button class="btn btn-outline" onclick="downloadResults()" aria-label="ÏöîÏïΩ Í≤∞Í≥º Îã§Ïö¥Î°úÎìú" title="ÌÖçÏä§Ìä∏ ÌååÏùºÎ°ú Ï†ÄÏû•">
                        üíæ Ï†ÄÏû•ÌïòÍ∏∞
                    </button>
                    <button class="btn btn-outline" onclick="shareResults()" aria-label="ÏöîÏïΩ Í≤∞Í≥º Í≥µÏú†ÌïòÍ∏∞" title="ÎßÅÌÅ¨Î°ú Í≥µÏú†">
                        üîó Í≥µÏú†ÌïòÍ∏∞
                    </button>
                    <button class="btn btn-outline" onclick="resetApp()" aria-label="ÏÉàÎ°ú ÏãúÏûëÌïòÍ∏∞" title="Ï≤òÏùåÎ∂ÄÌÑ∞ Îã§Ïãú">
                        üîÑ ÏÉàÎ°ú ÏãúÏûë
                    </button>
                </div>
            </div>
            <div id="results-content" class="results-content" role="article" aria-label="ÏöîÏïΩ Í≤∞Í≥º ÎÇ¥Ïö©">
                <!-- Summary content will be inserted here -->
            </div>
        </section>
    </div>

    <!-- Toast notification container -->
    <div id="toast-container" class="toast-container" aria-live="polite" aria-atomic="true"></div>

    <!-- API Configuration Modal -->
    <div id="api-config-modal" class="modal hidden" role="dialog" aria-labelledby="modal-title" aria-modal="true">
        <div class="modal-backdrop" onclick="closeApiConfigModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title" class="modal-title">API ÏÑ§Ï†ï</h3>
                <button class="modal-close" onclick="closeApiConfigModal()" aria-label="Î™®Îã¨ Îã´Í∏∞">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="api-key-input">OpenRouter API ÌÇ§</label>
                    <input type="password" id="api-key-input" class="form-control"
                           placeholder="sk-or-v1-..." aria-describedby="api-key-help">
                    <div id="api-key-help" class="form-help">
                        OpenRouterÏóêÏÑú Î∞úÍ∏âÎ∞õÏùÄ API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.
                        <a href="https://openrouter.ai" target="_blank" rel="noopener">API ÌÇ§ Î∞úÍ∏âÎ∞õÍ∏∞</a>
                    </div>
                </div>
                <div class="form-group">
                    <label for="model-select">AI Î™®Îç∏ ÏÑ†ÌÉù</label>
                    <select id="model-select" class="form-control">
                        <option value="deepseek/deepseek-chat">DeepSeek V3.1 (Ï∂îÏ≤ú)</option>
                        <option value="deepseek/deepseek-coder">DeepSeek Coder</option>
                        <option value="google/gemini-flash-1.5">Gemini 1.5 Flash</option>
                        <option value="anthropic/claude-3-haiku">Claude 3 Haiku</option>
                    </select>
                </div>
                <div class="security-warning">
                    <strong>‚ö†Ô∏è Î≥¥Ïïà ÏïåÎ¶º:</strong> API ÌÇ§Îäî Î∏åÎùºÏö∞Ï†ÄÏóêÏÑúÎßå ÏÇ¨Ïö©ÎêòÎ©∞ Ï†ÄÏû•ÎêòÏßÄ ÏïäÏäµÎãàÎã§.
                    ÌîÑÎ°úÎçïÏÖò ÌôòÍ≤ΩÏóêÏÑúÎäî ÏÑúÎ≤Ñ ÏÇ¨Ïù¥Îìú Íµ¨ÌòÑÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-outline" onclick="closeApiConfigModal()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="saveApiConfig()">Ï†ÄÏû•ÌïòÍ∏∞</button>
                <button class="btn btn-secondary" onclick="testApiConnection()">Ïó∞Í≤∞ ÌÖåÏä§Ìä∏</button>
            </div>
        </div>
    </div>

    <!-- PDF.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <script>
        // Set PDF.js worker path
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // Global application state
        const AppState = {
            currentFile: null,
            currentSummaryMode: 'normal',
            summaryResult: '',
            isProcessing: false,
            theme: 'light',
            apiKey: '',
            selectedModel: 'deepseek/deepseek-chat',
            apiClient: null,
            maxFileSize: 50 * 1024 * 1024, // 50MB configurable limit
            supportedFileTypes: ['application/pdf'],
            processingTimeout: 300000 // 5 minutes
        };

        // OpenRouter API Client (Inline Implementation)
        class OpenRouterClient {
            constructor(config = {}) {
                this.apiKey = config.apiKey || '';
                this.baseUrl = config.baseUrl || 'https://openrouter.ai/api/v1';
                this.model = config.model || 'deepseek/deepseek-chat';
                this.maxRetries = config.maxRetries || 3;
                this.retryDelay = config.retryDelay || 1000;
                this.requestTimeout = config.requestTimeout || 60000;
            }

            async makeRequest(endpoint, data) {
                const url = `${this.baseUrl}${endpoint}`;
                const headers = {
                    'Authorization': `Bearer ${this.apiKey}`,
                    'Content-Type': 'application/json',
                    'HTTP-Referer': window.location.origin,
                    'X-Title': 'PDF Î¨∏ÏÑú ÏöîÏïΩ ÏÑúÎπÑÏä§'
                };

                for (let attempt = 0; attempt < this.maxRetries; attempt++) {
                    try {
                        const controller = new AbortController();
                        const timeoutId = setTimeout(() => controller.abort(), this.requestTimeout);

                        const response = await fetch(url, {
                            method: 'POST',
                            headers,
                            body: JSON.stringify(data),
                            signal: controller.signal
                        });

                        clearTimeout(timeoutId);

                        if (!response.ok) {
                            const errorData = await response.json().catch(() => ({}));
                            throw new Error(`API Error (${response.status}): ${errorData.error?.message || response.statusText}`);
                        }

                        return await response.json();
                    } catch (error) {
                        if (attempt === this.maxRetries - 1) {
                            throw error;
                        }
                        await new Promise(resolve => setTimeout(resolve, this.retryDelay * Math.pow(2, attempt)));
                    }
                }
            }

            async testConnection() {
                try {
                    const result = await this.makeRequest('/chat/completions', {
                        model: this.model,
                        messages: [{ role: 'user', content: 'ÏïàÎÖïÌïòÏÑ∏Ïöî. ÌÖåÏä§Ìä∏ Î©îÏãúÏßÄÏûÖÎãàÎã§.' }],
                        max_tokens: 10
                    });
                    return { success: true, data: result };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }

            async summarizeText(text, mode = 'normal', options = {}) {
                const prompts = {
                    simple: `Îã§Ïùå ÌÖçÏä§Ìä∏Î•º Í∞ÑÎã®ÌïòÍ≥† Î™ÖÌôïÌïòÍ≤å ÏöîÏïΩÌï¥Ï£ºÏÑ∏Ïöî. ÌïµÏã¨ Ìè¨Ïù∏Ìä∏Îßå 3-5Í∞ú Ï†ïÎèÑÎ°ú Ï†ïÎ¶¨Ìï¥Ï£ºÏÑ∏Ïöî:\n\n${text}`,
                    normal: `Îã§Ïùå ÌÖçÏä§Ìä∏Î•º Ï≤¥Í≥ÑÏ†ÅÏúºÎ°ú ÏöîÏïΩÌï¥Ï£ºÏÑ∏Ïöî. Ï£ºÏöî ÎÇ¥Ïö©, ÌïµÏã¨ Ìè¨Ïù∏Ìä∏, Í≤∞Î°†ÏùÑ Ìè¨Ìï®ÌïòÏó¨ Í∑†ÌòïÏûàÍ≤å Ï†ïÎ¶¨Ìï¥Ï£ºÏÑ∏Ïöî:\n\n${text}`,
                    detailed: `Îã§Ïùå ÌÖçÏä§Ìä∏Î•º ÏÉÅÏÑ∏ÌïòÍ≤å Î∂ÑÏÑùÌïòÍ≥† ÏöîÏïΩÌï¥Ï£ºÏÑ∏Ïöî. Î∞∞Í≤Ω, Ï£ºÏöî ÎÇ¥Ïö©, ÏÑ∏Î∂ÄÏÇ¨Ìï≠, Í≤∞Î°†, ÏãúÏÇ¨Ï†êÏùÑ Î™®Îëê Ìè¨Ìï®ÌïòÏó¨ Ìè¨Í¥ÑÏ†ÅÏúºÎ°ú Ï†ïÎ¶¨Ìï¥Ï£ºÏÑ∏Ïöî:\n\n${text}`
                };

                const data = {
                    model: this.model,
                    messages: [
                        {
                            role: 'system',
                            content: 'ÎãπÏã†ÏùÄ ÌïúÍµ≠Ïñ¥ Î¨∏ÏÑú ÏöîÏïΩ Ï†ÑÎ¨∏Í∞ÄÏûÖÎãàÎã§. Ï£ºÏñ¥ÏßÑ ÌÖçÏä§Ìä∏Î•º ÏùΩÍ∏∞ ÏâΩÍ≥† Ïù¥Ìï¥ÌïòÍ∏∞ ÏâΩÍ≤å ÏöîÏïΩÌï¥Ï£ºÏÑ∏Ïöî. ÎßàÌÅ¨Îã§Ïö¥ ÌòïÏãùÏùÑ ÏÇ¨Ïö©ÌïòÏó¨ Íµ¨Ï°∞ÌôîÌï¥Ï£ºÏÑ∏Ïöî.'
                        },
                        {
                            role: 'user',
                            content: prompts[mode]
                        }
                    ],
                    max_tokens: mode === 'simple' ? 500 : mode === 'normal' ? 1000 : 2000,
                    temperature: 0.3,
                    top_p: 0.9
                };

                return await this.makeRequest('/chat/completions', data);
            }
        }

        // PDF Text Extraction with enhanced error handling
        async function extractTextFromPDF(file) {
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();
                let timeoutId;

                // Set timeout for file reading
                timeoutId = setTimeout(() => {
                    fileReader.abort();
                    reject(new Error('ÌååÏùº ÏùΩÍ∏∞ ÏãúÍ∞Ñ Ï¥àÍ≥º'));
                }, 30000); // 30 second timeout

                fileReader.onload = async function() {
                    clearTimeout(timeoutId);
                    try {
                        const typedarray = new Uint8Array(this.result);
                        const loadingTask = pdfjsLib.getDocument({
                            data: typedarray,
                            cMapPacked: true,
                            cMapUrl: 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/cmaps/'
                        });

                        const pdf = await loadingTask.promise;
                        let fullText = '';
                        let totalCharacters = 0;
                        const maxTextLength = 100000; // Limit extracted text size

                        for (let i = 1; i <= pdf.numPages && totalCharacters < maxTextLength; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            const pageText = textContent.items.map(item => sanitizeText(item.str)).join(' ');

                            if (pageText.trim()) {
                                fullText += pageText + '\n\n';
                                totalCharacters += pageText.length;
                            }

                            // Cleanup page resources
                            page.cleanup();
                        }

                        const cleanedText = fullText.trim();

                        // Validate extracted text
                        if (!cleanedText || cleanedText.length < 10) {
                            reject(new Error('PDFÏóêÏÑú ÏùΩÏùÑ Ïàò ÏûàÎäî ÌÖçÏä§Ìä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Ïù¥ÎØ∏ÏßÄ Ï†ÑÏö© PDFÏù¥Í±∞ÎÇò ÌÖçÏä§Ìä∏Í∞Ä ÏÜêÏÉÅÎêòÏóàÏùÑ Ïàò ÏûàÏäµÎãàÎã§.'));
                            return;
                        }

                        if (cleanedText.length < 50) {
                            reject(new Error('Ï∂îÏ∂úÎêú ÌÖçÏä§Ìä∏Í∞Ä ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§. ÏùòÎØ∏ ÏûàÎäî ÏöîÏïΩÏùÑ ÏÉùÏÑ±ÌïòÍ∏∞Ïóê Ï∂©Î∂ÑÌïòÏßÄ ÏïäÏäµÎãàÎã§.'));
                            return;
                        }

                        resolve(cleanedText);
                    } catch (error) {
                        if (error.name === 'InvalidPDFException') {
                            reject(new Error('ÏÜêÏÉÅÎêú PDF ÌååÏùºÏûÖÎãàÎã§. Îã§Î•∏ ÌååÏùºÏùÑ ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.'));
                        } else if (error.name === 'MissingPDFException') {
                            reject(new Error('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ PDF ÌååÏùºÏûÖÎãàÎã§.'));
                        } else {
                            reject(new Error(`PDF Ï≤òÎ¶¨ Ïò§Î•ò: ${error.message}`));
                        }
                    }
                };

                fileReader.onerror = () => {
                    clearTimeout(timeoutId);
                    reject(new Error('ÌååÏùº ÏùΩÍ∏∞ Ïã§Ìå®'));
                };

                fileReader.readAsArrayBuffer(file);
            });
        }

        // Text sanitization function
        function sanitizeText(text) {
            if (!text || typeof text !== 'string') return '';

            // Remove potentially dangerous characters and normalize whitespace
            return text
                .replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g, '') // Remove control characters
                .replace(/[<>&"']/g, (char) => {
                    const entities = { '<': '&lt;', '>': '&gt;', '&': '&amp;', '"': '&quot;', "'": '&#x27;' };
                    return entities[char] || char;
                })
                .replace(/\s+/g, ' ') // Normalize whitespace
                .trim();
        }

        // Theme management
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');
            const currentTheme = body.getAttribute('data-theme');

            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.textContent = 'üåô';
                AppState.theme = 'light';
                localStorage.setItem('pdf-summary-theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
                AppState.theme = 'dark';
                localStorage.setItem('pdf-summary-theme', 'dark');
            }
        }

        // Initialize theme on page load
        function initTheme() {
            const savedTheme = localStorage.getItem('pdf-summary-theme');
            if (savedTheme === 'dark' || (savedTheme === null && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.body.setAttribute('data-theme', 'dark');
                document.getElementById('theme-icon').textContent = '‚òÄÔ∏è';
                AppState.theme = 'dark';
            }
        }

        // File handling functions
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processFile(file);
            }
        }

        function handleDrop(event) {
            event.preventDefault();
            const uploadArea = event.target.closest('.upload-area');
            uploadArea.classList.remove('drag-over');

            const files = event.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
        }

        function handleDragEnter(event) {
            event.preventDefault();
            const uploadArea = event.target.closest('.upload-area');
            uploadArea.classList.add('drag-over');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            const uploadArea = event.target.closest('.upload-area');
            const rect = uploadArea.getBoundingClientRect();
            const x = event.clientX;
            const y = event.clientY;

            if (x < rect.left || x >= rect.right || y < rect.top || y >= rect.bottom) {
                uploadArea.classList.remove('drag-over');
            }
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                document.getElementById('file-input').click();
            }
        }

        function processFile(file) {
            // Validate file type
            if (!AppState.supportedFileTypes.includes(file.type)) {
                showToast('PDF ÌååÏùºÎßå ÏóÖÎ°úÎìúÌï† Ïàò ÏûàÏäµÎãàÎã§.', 'error', 'PDF ÌòïÏãù Ïò§Î•ò');
                return;
            }

            // Validate file size
            if (file.size > AppState.maxFileSize) {
                showToast(`ÌååÏùº ÌÅ¨Í∏∞Í∞Ä ÎÑàÎ¨¥ ÌÅΩÎãàÎã§. ÏµúÎåÄ ${formatFileSize(AppState.maxFileSize)}ÍπåÏßÄ ÏóÖÎ°úÎìú Í∞ÄÎä•Ìï©ÎãàÎã§.`, 'error', 'ÌååÏùº ÌÅ¨Í∏∞ Ï¥àÍ≥º');
                return;
            }

            // Validate file is not empty
            if (file.size === 0) {
                showToast('Îπà ÌååÏùºÏùÄ ÏóÖÎ°úÎìúÌï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error', 'ÌååÏùº Ïò§Î•ò');
                return;
            }

            AppState.currentFile = file;

            // Update UI
            displayFileInfo(file);
            enableProcessButton();

            // Simulate upload progress
            simulateUpload();

            showToast('PDF ÌååÏùºÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏóÖÎ°úÎìúÎêòÏóàÏäµÎãàÎã§.', 'success', 'ÏóÖÎ°úÎìú ÏôÑÎ£å');
        }

        function displayFileInfo(file) {
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');

            fileName.textContent = file.name;
            fileSize.textContent = `ÌÅ¨Í∏∞: ${formatFileSize(file.size)} ‚Ä¢ Ïú†Ìòï: PDF Î¨∏ÏÑú`;

            fileInfo.classList.add('show');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function simulateUpload() {
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');
            const progressPercent = document.getElementById('progress-percent');
            const progressStatus = document.getElementById('progress-status');

            progressContainer.classList.add('show');
            progressStatus.textContent = 'ÌååÏùºÏùÑ Ï≤òÎ¶¨ÌïòÍ≥† ÏûàÏäµÎãàÎã§...';

            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 12 + 3; // 3-15% increments
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    progressStatus.textContent = 'ÏóÖÎ°úÎìúÍ∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!';
                    setTimeout(() => {
                        progressContainer.classList.remove('show');
                    }, 2000);
                }

                progressBar.style.width = progress + '%';
                progressPercent.textContent = Math.round(progress) + '%';
            }, 150);
        }

        function removeFile() {
            AppState.currentFile = null;
            document.getElementById('file-input').value = '';
            document.getElementById('file-info').classList.remove('show');
            document.getElementById('progress-container').classList.remove('show');
            disableProcessButton();
            showToast('ÌååÏùºÏù¥ Ï†úÍ±∞ÎêòÏóàÏäµÎãàÎã§.', 'success', 'ÌååÏùº Ï†úÍ±∞');
        }

        // Summary options management
        function selectOption(mode) {
            const options = document.querySelectorAll('.option-card');
            options.forEach(option => {
                option.classList.remove('selected');
                option.setAttribute('aria-checked', 'false');
            });

            const selectedOption = document.querySelector(`[data-mode="${mode}"]`);
            selectedOption.classList.add('selected');
            selectedOption.setAttribute('aria-checked', 'true');

            AppState.currentSummaryMode = mode;

            // Provide user feedback
            const modeNames = {
                simple: 'Í∞ÑÎã® ÏöîÏïΩ',
                normal: 'ÏùºÎ∞ò ÏöîÏïΩ',
                detailed: 'ÏÉÅÏÑ∏ ÏöîÏïΩ'
            };

            showToast(`${modeNames[mode]} Î™®ÎìúÍ∞Ä ÏÑ†ÌÉùÎêòÏóàÏäµÎãàÎã§.`, 'success', 'Î™®Îìú Î≥ÄÍ≤Ω');
        }

        function enableProcessButton() {
            const button = document.getElementById('process-button');
            const text = document.getElementById('process-text');
            const icon = document.getElementById('process-icon');

            button.classList.add('enabled');
            text.textContent = 'ÏöîÏïΩ ÏÉùÏÑ±ÌïòÍ∏∞';
            icon.textContent = '‚ú®';
        }

        function disableProcessButton() {
            const button = document.getElementById('process-button');
            const text = document.getElementById('process-text');
            const icon = document.getElementById('process-icon');

            button.classList.remove('enabled');
            text.textContent = 'ÌååÏùºÏùÑ Î®ºÏ†Ä ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî';
            icon.textContent = 'üìÑ';
        }

        // Summary processing
        async function startSummary() {
            if (!AppState.currentFile) {
                showToast('Î®ºÏ†Ä PDF ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'ÌååÏùº ÌïÑÏöî');
                return;
            }

            if (AppState.isProcessing) {
                return;
            }

            AppState.isProcessing = true;

            const button = document.getElementById('process-button');
            const text = document.getElementById('process-text');
            const icon = document.getElementById('process-icon');

            // Update button state
            button.classList.add('processing');
            text.textContent = 'AIÍ∞Ä Î¨∏ÏÑúÎ•º Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...';
            icon.innerHTML = '<div class="spinner"></div>';

            try {
                // Show progress during processing
                await simulateSummaryProcessing();

                // Display results
                displayResults();
                showToast('Î¨∏ÏÑú ÏöîÏïΩÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!', 'success', 'ÏöîÏïΩ ÏôÑÎ£å');

            } catch (error) {
                showToast('ÏöîÏïΩ Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error', 'Ï≤òÎ¶¨ Ïò§Î•ò');
                console.error('Summary error:', error);
            } finally {
                // Reset button
                AppState.isProcessing = false;
                button.classList.remove('processing');
                text.textContent = 'ÏöîÏïΩ ÏÉùÏÑ±ÌïòÍ∏∞';
                icon.textContent = '‚ú®';
            }
        }

        // Modal focus management
        let previousActiveElement = null;
        const focusableElementsSelector = 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';

        function trapFocus(element) {
            const focusableElements = element.querySelectorAll(focusableElementsSelector);
            const firstElement = focusableElements[0];
            const lastElement = focusableElements[focusableElements.length - 1];

            element.addEventListener('keydown', (e) => {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        if (document.activeElement === firstElement) {
                            e.preventDefault();
                            lastElement.focus();
                        }
                    } else {
                        if (document.activeElement === lastElement) {
                            e.preventDefault();
                            firstElement.focus();
                        }
                    }
                }
                if (e.key === 'Escape') {
                    closeApiConfigModal();
                }
            });
        }

        // API Configuration Modal Functions
        function openApiConfigModal() {
            const modal = document.getElementById('api-config-modal');
            const apiKeyInput = document.getElementById('api-key-input');
            const modelSelect = document.getElementById('model-select');

            // Store current focus
            previousActiveElement = document.activeElement;

            // Load current values
            apiKeyInput.value = AppState.apiKey;
            modelSelect.value = AppState.selectedModel;

            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.add('show');
                apiKeyInput.focus();
                trapFocus(modal);
            }, 10);
        }

        function closeApiConfigModal() {
            const modal = document.getElementById('api-config-modal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.classList.add('hidden');
                // Restore focus to previously active element
                if (previousActiveElement) {
                    previousActiveElement.focus();
                    previousActiveElement = null;
                }
            }, 300);
        }

        function saveApiConfig() {
            const apiKey = document.getElementById('api-key-input').value.trim();
            const model = document.getElementById('model-select').value;

            if (!apiKey) {
                showToast('API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error', 'ÏûÖÎ†• Ïò§Î•ò');
                return;
            }

            if (!apiKey.startsWith('sk-or-v1-')) {
                showToast('Ïò¨Î∞îÎ•∏ OpenRouter API ÌÇ§ ÌòïÏãùÏù¥ ÏïÑÎãôÎãàÎã§.', 'error', 'ÌòïÏãù Ïò§Î•ò');
                return;
            }

            AppState.apiKey = apiKey;
            AppState.selectedModel = model;
            AppState.apiClient = new OpenRouterClient({
                apiKey: apiKey,
                model: model
            });

            closeApiConfigModal();
            showToast('API ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.', 'success', 'ÏÑ§Ï†ï ÏôÑÎ£å');
        }

        async function testApiConnection() {
            const apiKey = document.getElementById('api-key-input').value.trim();
            const model = document.getElementById('model-select').value;

            if (!apiKey) {
                showToast('API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error', 'ÏûÖÎ†• Ïò§Î•ò');
                return;
            }

            const testButton = document.querySelector('.modal-actions .btn-secondary');
            const originalText = testButton.innerHTML;
            testButton.innerHTML = '<div class="spinner"></div> ÌÖåÏä§Ìä∏ Ï§ë...';
            testButton.disabled = true;

            try {
                const client = new OpenRouterClient({ apiKey, model });
                const result = await client.testConnection();

                if (result.success) {
                    showToast('API Ïó∞Í≤∞Ïù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÌôïÏù∏ÎêòÏóàÏäµÎãàÎã§!', 'success', 'Ïó∞Í≤∞ ÏÑ±Í≥µ');
                } else {
                    showToast(`Ïó∞Í≤∞ Ïã§Ìå®: ${result.error}`, 'error', 'Ïó∞Í≤∞ Ïã§Ìå®');
                }
            } catch (error) {
                showToast(`Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ï§ë Ïò§Î•ò: ${error.message}`, 'error', 'ÌÖåÏä§Ìä∏ Ïò§Î•ò');
            } finally {
                testButton.innerHTML = originalText;
                testButton.disabled = false;
            }
        }

        async function processPDFAndSummarize() {
            if (!AppState.apiClient) {
                showToast('Î®ºÏ†Ä APIÎ•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'API ÏÑ§Ï†ï ÌïÑÏöî');
                openApiConfigModal();
                return;
            }

            const text = document.getElementById('process-text');
            let extractedText = null;

            try {
                // Extract text from PDF with timeout
                text.textContent = 'PDFÏóêÏÑú ÌÖçÏä§Ìä∏Î•º Ï∂îÏ∂úÌïòÍ≥† ÏûàÏäµÎãàÎã§...';

                const extractionPromise = extractTextFromPDF(AppState.currentFile);
                const timeoutPromise = new Promise((_, reject) =>
                    setTimeout(() => reject(new Error('ÌÖçÏä§Ìä∏ Ï∂îÏ∂ú ÏãúÍ∞Ñ Ï¥àÍ≥º')), 60000)
                );

                extractedText = await Promise.race([extractionPromise, timeoutPromise]);

                // Validate extracted text length
                if (!extractedText || extractedText.trim().length < 50) {
                    throw new Error('PDFÏóêÏÑú Ï∂©Î∂ÑÌïú ÌÖçÏä§Ìä∏Î•º Ï∂îÏ∂úÌï† Ïàò ÏóÜÏäµÎãàÎã§. ÌÖçÏä§Ìä∏Í∞Ä Ìè¨Ìï®Îêú PDF ÌååÏùºÏù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.');
                }

                // Smart text truncation with better logic
                const maxLength = 15000; // Increased limit for better context
                let textToSummarize = extractedText;

                if (extractedText.length > maxLength) {
                    // Try to cut at sentence boundaries
                    const truncated = extractedText.substring(0, maxLength);
                    const lastSentence = truncated.lastIndexOf('.');
                    const lastQuestion = truncated.lastIndexOf('?');
                    const lastExclamation = truncated.lastIndexOf('!');

                    const bestCutoff = Math.max(lastSentence, lastQuestion, lastExclamation);

                    if (bestCutoff > maxLength * 0.7) { // If we can cut at 70% or more
                        textToSummarize = extractedText.substring(0, bestCutoff + 1);
                    } else {
                        textToSummarize = truncated;
                    }

                    textToSummarize += '\n\n[Ï∞∏Í≥†: ÌÖçÏä§Ìä∏Í∞Ä Í∏∏Ïñ¥ÏÑú ÏùºÎ∂ÄÎßå ÏöîÏïΩÎêòÏóàÏäµÎãàÎã§]';
                }

                // Generate summary using AI with retry logic
                text.textContent = 'AIÍ∞Ä Î¨∏ÏÑúÎ•º Î∂ÑÏÑùÌïòÍ≥† ÏöîÏïΩÏùÑ ÏÉùÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§...';

                let result;
                let retryCount = 0;
                const maxRetries = 2;

                while (retryCount <= maxRetries) {
                    try {
                        result = await Promise.race([
                            AppState.apiClient.summarizeText(textToSummarize, AppState.currentSummaryMode),
                            new Promise((_, reject) =>
                                setTimeout(() => reject(new Error('AI Ï≤òÎ¶¨ ÏãúÍ∞Ñ Ï¥àÍ≥º')), AppState.processingTimeout)
                            )
                        ]);
                        break;
                    } catch (apiError) {
                        retryCount++;
                        if (retryCount <= maxRetries) {
                            text.textContent = `Ïó∞Í≤∞ Ïò§Î•òÎ°ú Ïû¨ÏãúÎèÑ Ï§ë... (${retryCount}/${maxRetries})`;
                            await new Promise(resolve => setTimeout(resolve, 2000 * retryCount)); // Exponential backoff
                        } else {
                            throw apiError;
                        }
                    }
                }

                if (!result || !result.choices || !result.choices[0] || !result.choices[0].message) {
                    throw new Error('AI ÏÑúÎπÑÏä§ÏóêÏÑú Ïò¨Î∞îÎ•∏ ÏùëÎãµÏùÑ Î∞õÏßÄ Î™ªÌñàÏäµÎãàÎã§.');
                }

                const summaryContent = result.choices[0].message.content;
                if (!summaryContent || summaryContent.trim().length < 10) {
                    throw new Error('AIÍ∞Ä ÏÉùÏÑ±Ìïú ÏöîÏïΩÏù¥ ÎÑàÎ¨¥ ÏßßÏäµÎãàÎã§.');
                }

                AppState.summaryResult = sanitizeText(summaryContent);

                // Add comprehensive metadata
                const fileSize = formatFileSize(AppState.currentFile.size);
                const currentTime = new Date().toLocaleString('ko-KR');
                const compressionRatio = Math.round((AppState.summaryResult.length / extractedText.length) * 100);

                const metadata = `\n\n---\nüìä Î¨∏ÏÑú Î∂ÑÏÑù Ï†ïÎ≥¥\n` +
                    `‚Ä¢ ÏõêÎ≥∏ ÌååÏùº: ${AppState.currentFile.name}\n` +
                    `‚Ä¢ ÌååÏùº ÌÅ¨Í∏∞: ${fileSize}\n` +
                    `‚Ä¢ ÏöîÏïΩ ÏôÑÎ£å ÏãúÍ∞Ñ: ${currentTime}\n` +
                    `‚Ä¢ Ï∂îÏ∂úÎêú ÌÖçÏä§Ìä∏: ${extractedText.length.toLocaleString()}Ïûê\n` +
                    `‚Ä¢ ÏöîÏïΩ Í∏∏Ïù¥: ${AppState.summaryResult.length.toLocaleString()}Ïûê\n` +
                    `‚Ä¢ ÏïïÏ∂ïÎ•†: ${compressionRatio}%\n` +
                    `‚Ä¢ AI Î™®Îç∏: ${AppState.selectedModel}\n` +
                    `‚Ä¢ ÏöîÏïΩ Î™®Îìú: ${AppState.currentSummaryMode}`;

                AppState.summaryResult += metadata;

            } catch (error) {
                // Enhanced error reporting
                console.error('PDF processing error:', error);

                let userFriendlyMessage;
                if (error.message.includes('ÏãúÍ∞Ñ Ï¥àÍ≥º')) {
                    userFriendlyMessage = 'Ï≤òÎ¶¨ ÏãúÍ∞ÑÏù¥ ÎÑàÎ¨¥ Ïò§Îûò Í±∏Î¶ΩÎãàÎã§. Îçî ÏûëÏùÄ ÌååÏùºÏùÑ ÏãúÎèÑÌï¥Î≥¥Í±∞ÎÇò ÎÇòÏ§ëÏóê Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.message.includes('API')) {
                    userFriendlyMessage = 'AI ÏÑúÎπÑÏä§ Ïó∞Í≤∞Ïóê Î¨∏Ï†úÍ∞Ä ÏûàÏäµÎãàÎã§. ÎÑ§Ìä∏ÏõåÌÅ¨ Ïó∞Í≤∞ÏùÑ ÌôïÏù∏ÌïòÍ≥† Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                } else if (error.message.includes('ÌÖçÏä§Ìä∏')) {
                    userFriendlyMessage = error.message;
                } else {
                    userFriendlyMessage = `Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ${error.message}`;
                }

                throw new Error(userFriendlyMessage);
            }
        }

        async function simulateSummaryProcessing() {
            if (AppState.apiClient) {
                // Real API processing
                await processPDFAndSummarize();
            } else {
                // Fallback to demo mode
                const phases = [
                    { text: 'PDF ÌååÏùºÏùÑ ÏùΩÍ≥† ÏûàÏäµÎãàÎã§...', duration: 1000 },
                    { text: 'AIÍ∞Ä Î¨∏ÏÑú ÎÇ¥Ïö©ÏùÑ Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...', duration: 2000 },
                    { text: 'ÌïµÏã¨ ÎÇ¥Ïö©ÏùÑ Ï∂îÏ∂úÌïòÍ≥† ÏûàÏäµÎãàÎã§...', duration: 1500 },
                    { text: 'ÏöîÏïΩÏùÑ ÏÉùÏÑ±ÌïòÍ≥† ÏûàÏäµÎãàÎã§...', duration: 1000 }
                ];

                const text = document.getElementById('process-text');

                for (const phase of phases) {
                    text.textContent = phase.text;
                    await new Promise(resolve => setTimeout(resolve, phase.duration));
                }

                // Generate mock summary
                generateMockSummary();
                showToast('Îç∞Î™® Î™®ÎìúÎ°ú Ïã§ÌñâÎêòÏóàÏäµÎãàÎã§. Ïã§Ï†ú AI ÏöîÏïΩÏùÑ ÏÇ¨Ïö©ÌïòÎ†§Î©¥ APIÎ•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.', 'warning', 'Îç∞Î™® Î™®Îìú');
            }
        }

        function generateMockSummary() {
            const fileName = AppState.currentFile.name.replace('.pdf', '');
            const fileSize = formatFileSize(AppState.currentFile.size);
            const currentTime = new Date().toLocaleString('ko-KR');

            const summaries = {
                simple: `üìã ${fileName} - Í∞ÑÎã® ÏöîÏïΩ

üîç ÌïµÏã¨ ÎÇ¥Ïö©
‚Ä¢ Ï£ºÏöî ÌÜ†ÌîΩ 1: Î¨∏ÏÑúÏùò Ï≤´ Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú
‚Ä¢ Ï£ºÏöî ÌÜ†ÌîΩ 2: Î¨∏ÏÑúÏùò Îëê Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú
‚Ä¢ Ï£ºÏöî ÌÜ†ÌîΩ 3: Î¨∏ÏÑúÏùò ÏÑ∏ Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú

üí° Í≤∞Î°†
Ïù¥ Î¨∏ÏÑúÏùò Í∞ÄÏû• Ï§ëÏöîÌïú Î©îÏãúÏßÄÏôÄ Í≤∞Î°†ÏùÑ Ìïú Î¨∏Ïû•ÏúºÎ°ú ÏöîÏïΩÌï©ÎãàÎã§.

---
üìä Î¨∏ÏÑú Ï†ïÎ≥¥: ${fileSize} | ‚è∞ ÏöîÏïΩ ÏãúÍ∞Ñ: ${currentTime}`,

                normal: `üìã ${fileName} - ÏùºÎ∞ò ÏöîÏïΩ

üîç Î¨∏ÏÑú Í∞úÏöî
Ïù¥ PDF Î¨∏ÏÑúÎäî [Ï£ºÏöî Ï£ºÏ†ú]Ïóê ÎåÄÌïú Ìè¨Í¥ÑÏ†ÅÏù∏ ÎÇ¥Ïö©ÏùÑ Îã§Î£®Í≥† ÏûàÏúºÎ©∞, Ï¥ù ${Math.ceil(AppState.currentFile.size / 1024)}KB Î∂ÑÎüâÏùò Ï†ïÎ≥¥Î•º Ìè¨Ìï®ÌïòÍ≥† ÏûàÏäµÎãàÎã§.

üìå Ï£ºÏöî ÎÇ¥Ïö©
1Ô∏è‚É£ Ï≤´ Î≤àÏß∏ ÏÑπÏÖò
   ‚Ä¢ ÌïµÏã¨ Í∞úÎÖêÍ≥º Í∏∞Î≥∏ ÏõêÎ¶¨ ÏÑ§Î™Ö
   ‚Ä¢ Í¥ÄÎ†® Îç∞Ïù¥ÌÑ∞ Î∞è ÌÜµÍ≥Ñ ÏûêÎ£å Ï†úÏãú
   ‚Ä¢ Íµ¨Ï≤¥Ï†ÅÏù∏ ÏÇ¨Î°ÄÏôÄ ÏòàÏãú Î∂ÑÏÑù

2Ô∏è‚É£ Îëê Î≤àÏß∏ ÏÑπÏÖò
   ‚Ä¢ Ïã¨ÌôîÎêú ÎÇ¥Ïö©Í≥º ÏÑ∏Î∂Ä ÏÇ¨Ìï≠
   ‚Ä¢ ÎπÑÍµê Î∂ÑÏÑù Î∞è ÎåÄÏïà Ï†úÏãú
   ‚Ä¢ Ïã§Î¨¥ Ï†ÅÏö© Î∞©Ïïà ÎÖºÏùò

3Ô∏è‚É£ ÏÑ∏ Î≤àÏß∏ ÏÑπÏÖò
   ‚Ä¢ Í≤∞Í≥º Ìï¥ÏÑù Î∞è ÏãúÏÇ¨Ï†ê
   ‚Ä¢ Ìñ•ÌõÑ Ï†ÑÎßùÍ≥º Î∞úÏ†Ñ Î∞©Ìñ•
   ‚Ä¢ Ï†úÌïúÏÇ¨Ìï≠ Î∞è Í≥†Î†§ÏÇ¨Ìï≠

üí° ÌïµÏã¨ Î©îÏãúÏßÄ
Î¨∏ÏÑúÏùò Ï£ºÏöî Í≤∞Î°†Í≥º ÎèÖÏûêÍ∞Ä ÏïåÏïÑÏïº Ìï† ÌïµÏã¨ ÎÇ¥Ïö©ÏùÑ Î™ÖÌôïÌïòÍ≤å Ï†ïÎ¶¨ÌïòÏó¨ Ï†úÏãúÌï©ÎãàÎã§.

üéØ Ïã§Î¨¥ ÌôúÏö©
Ïù¥ ÎÇ¥Ïö©ÏùÑ Ïã§Ï†ú ÏóÖÎ¨¥ÎÇò ÌïôÏäµÏóê Ï†ÅÏö©Ìï† Îïå Í≥†Î†§Ìï¥Ïïº Ìï† Ï£ºÏöî Ìè¨Ïù∏Ìä∏Îì§ÏùÑ Ï†úÏïàÌï©ÎãàÎã§.

---
üìä Ï≤òÎ¶¨ Ï†ïÎ≥¥: ÏõêÎ≥∏ ${fileSize} | ‚è∞ ÏöîÏïΩ ÏôÑÎ£å: ${currentTime}`,

                detailed: `üìã ${fileName} - ÏÉÅÏÑ∏ ÏöîÏïΩ Î≥¥Í≥†ÏÑú

üìÑ Î¨∏ÏÑú Í∏∞Î≥∏ Ï†ïÎ≥¥
‚Ä¢ ÌååÏùºÎ™Ö: ${fileName}
‚Ä¢ ÌååÏùº ÌÅ¨Í∏∞: ${fileSize}
‚Ä¢ Ï≤òÎ¶¨ ÏùºÏãú: ${currentTime}
‚Ä¢ ÏöîÏïΩ Î™®Îìú: ÏÉÅÏÑ∏ Î∂ÑÏÑù

üîç Î¨∏ÏÑú Íµ¨Ï°∞ Î∞è ÎÇ¥Ïö© Î∂ÑÏÑù

1. ÏÑúÎ°† Î∞è Î∞∞Í≤Ω (Introduction & Background)
   üìç Î¨∏ÏÑúÏùò Î™©Ï†ÅÍ≥º Î≤îÏúÑ
   ‚Ä¢ Ïó∞Íµ¨/ÏûëÏÑ± Î™©Ï†ÅÍ≥º Î∞∞Í≤Ω ÏÑ§Î™Ö
   ‚Ä¢ Îã§Î£®Í≥†Ïûê ÌïòÎäî Ï£ºÏ†úÏùò Ï§ëÏöîÏÑ±
   ‚Ä¢ Î¨∏ÏÑúÏùò Íµ¨ÏÑ±Í≥º Ï†ëÍ∑º Î∞©Î≤ï

   üìç ÌïµÏã¨ Ïö©Ïñ¥ Î∞è Í∞úÎÖê Ï†ïÏùò
   ‚Ä¢ Ï£ºÏöî Ï†ÑÎ¨∏Ïö©Ïñ¥ Ìï¥ÏÑ§
   ‚Ä¢ Í∏∞Î≥∏ Í∞úÎÖêÍ≥º ÏõêÎ¶¨ ÏÑ§Î™Ö
   ‚Ä¢ ÏÑ†Ìñâ Ïó∞Íµ¨ Î∞è Ï∞∏Í≥† Î¨∏Ìóå

2. Î≥∏Î°† - Ï£ºÏöî ÎÇ¥Ïö© (Main Content)
   üìç Ï≤´ Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú
   ‚Ä¢ ÏÑ∏Î∂Ä ÎÇ¥Ïö©Í≥º Íµ¨Ï≤¥Ï†Å ÏÑ§Î™Ö
   ‚Ä¢ Í¥ÄÎ†® Îç∞Ïù¥ÌÑ∞, Ï∞®Ìä∏, Ìëú Î∂ÑÏÑù
   ‚Ä¢ Ïã§Ï†ú ÏÇ¨Î°Ä Î∞è Ï†ÅÏö© ÏòàÏãú
   ‚Ä¢ Ïû•Ï†êÍ≥º ÌïúÍ≥ÑÏ†ê Î∂ÑÏÑù

   üìç Îëê Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú
   ‚Ä¢ Ïã¨Ìôî Î∂ÑÏÑù Î∞è ÎπÑÍµê Ïó∞Íµ¨
   ‚Ä¢ Îã§ÏñëÌïú Í¥ÄÏ†êÍ≥º Ï†ëÍ∑ºÎ≤ï
   ‚Ä¢ ÎÖºÎûÄÏ†ê Î∞è ÏüÅÏ†ê ÏÇ¨Ìï≠
   ‚Ä¢ Ìï¥Í≤∞ Î∞©Ïïà Î∞è ÎåÄÏïà Ï†úÏãú

   üìç ÏÑ∏ Î≤àÏß∏ ÌïµÏã¨ Ï£ºÏ†ú
   ‚Ä¢ ÌÜµÌï©Ï†Å Í¥ÄÏ†êÏóêÏÑúÏùò Î∂ÑÏÑù
   ‚Ä¢ ÏÉÅÌò∏ Ïó∞Í¥ÄÏÑ± Î∞è ÏòÅÌñ• Í¥ÄÍ≥Ñ
   ‚Ä¢ ÎØ∏Îûò Ï†ÑÎßù Î∞è ÏòàÏ∏°
   ‚Ä¢ Ï†ïÏ±ÖÏ†Å/Ïã§Î¨¥Ï†Å Ìï®Ïùò

3. Í≤∞Î°† Î∞è Ï†úÏñ∏ (Conclusion & Recommendations)
   üìç Ï£ºÏöî Î∞úÍ≤¨ÏÇ¨Ìï≠ ÏöîÏïΩ
   ‚Ä¢ Í∞ÄÏû• Ï§ëÏöîÌïú Ïó∞Íµ¨ Í≤∞Í≥º
   ‚Ä¢ ÏòàÏÉÅÌñàÎçò Í≤ÉÍ≥º Îã§Î•∏ Î∞úÍ≤¨
   ‚Ä¢ ÏÉàÎ°úÏö¥ Ïù∏ÏÇ¨Ïù¥Ìä∏ÏôÄ Í¥ÄÏ†ê

   üìç Ïã§Î¨¥Ï†Å ÏãúÏÇ¨Ï†ê
   ‚Ä¢ ÌòÑÏû• Ï†ÅÏö© Í∞ÄÎä•ÏÑ±
   ‚Ä¢ Íµ¨Ï≤¥Ï†Å Ïã§Ìñâ Î∞©Ïïà
   ‚Ä¢ ÏòàÏÉÅÎêòÎäî Ìö®Í≥ºÏôÄ ÌïúÍ≥Ñ

   üìç Ìñ•ÌõÑ Í≥ºÏ†ú Î∞è Ïó∞Íµ¨ Î∞©Ìñ•
   ‚Ä¢ Ï∂îÍ∞Ä Ïó∞Íµ¨Í∞Ä ÌïÑÏöîÌïú ÏòÅÏó≠
   ‚Ä¢ Î≥¥ÏôÑÌï¥Ïïº Ìï† Î∂ÄÎ∂Ñ
   ‚Ä¢ Ïû•Í∏∞Ï†Å Î∞úÏ†Ñ Ï†ÑÎûµ

üí° ÌïµÏã¨ Ïù∏ÏÇ¨Ïù¥Ìä∏ (Key Insights)
üîπ Í∞ÄÏû• Ï§ëÏöîÌïú Î∞úÍ≤¨: [ÌïµÏã¨ Î©îÏãúÏßÄ 1]
üîπ Ïã§Î¨¥ Ï†ÅÏö© Ìè¨Ïù∏Ìä∏: [ÌïµÏã¨ Î©îÏãúÏßÄ 2]
üîπ Ï£ºÏùòÏÇ¨Ìï≠: [ÌïµÏã¨ Î©îÏãúÏßÄ 3]

üìä Î¨∏ÏÑú ÌíàÏßà ÌèâÍ∞Ä
‚Ä¢ ÎÇ¥Ïö©Ïùò Ïã†Î¢∞ÏÑ±: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
‚Ä¢ Ïã§Î¨¥ ÌôúÏö©ÎèÑ: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
‚Ä¢ Ïù¥Ìï¥ÌïòÍ∏∞ Ïâ¨ÏõÄ: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

üîó Ï∂îÍ∞Ä Ï∞∏Í≥†ÏÇ¨Ìï≠
‚Ä¢ Í¥ÄÎ†® Î¨∏ÏÑúÎÇò ÏûêÎ£åÏóê ÎåÄÌïú Ï∞∏Ï°∞
‚Ä¢ Ïã¨Ìôî ÌïôÏäµÏùÑ ÏúÑÌïú Ï∂îÏ≤ú ÏûêÎ£å
‚Ä¢ Î¨∏ÏùòÏÇ¨Ìï≠Ïù¥ÎÇò ÌîºÎìúÎ∞± Î∞©Î≤ï

---
‚ö° Ï≤òÎ¶¨ ÌÜµÍ≥Ñ
‚Ä¢ ÏõêÎ≥∏ Î¨∏ÏÑú: ${fileSize}
‚Ä¢ ÏöîÏïΩ ÏÉùÏÑ±: ${currentTime}
‚Ä¢ ÏïïÏ∂ïÎ•†: ÏïΩ 85% Îã®Ï∂ï
‚Ä¢ Ï≤òÎ¶¨ ÏãúÍ∞Ñ: 6.2Ï¥à
‚Ä¢ AI Î™®Îç∏: GPT-4 Í∏∞Î∞ò ÌïúÍµ≠Ïñ¥ ÏöîÏïΩ ÏóîÏßÑ`
            };

            AppState.summaryResult = summaries[AppState.currentSummaryMode];
        }

        function displayResults() {
            const resultsSection = document.getElementById('results-section');
            const resultsContent = document.getElementById('results-content');

            // Safely display sanitized results
            resultsContent.innerHTML = '';
            const pre = document.createElement('pre');
            pre.textContent = AppState.summaryResult; // Use textContent to prevent XSS
            pre.style.whiteSpace = 'pre-wrap';
            pre.style.fontFamily = 'inherit';
            resultsContent.appendChild(pre);
            resultsSection.classList.add('show');

            // Smooth scroll to results with offset for header
            setTimeout(() => {
                resultsSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 100);
        }

        // Results actions
        async function copyResults() {
            if (!AppState.summaryResult) {
                showToast('Î≥µÏÇ¨Ìï† ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.', 'warning', 'Î≥µÏÇ¨ Ïã§Ìå®');
                return;
            }

            try {
                await navigator.clipboard.writeText(AppState.summaryResult);
                showToast('ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.', 'success', 'Î≥µÏÇ¨ ÏôÑÎ£å');
            } catch (error) {
                // Fallback for older browsers
                try {
                    const textArea = document.createElement('textarea');
                    textArea.value = AppState.summaryResult;
                    textArea.style.position = 'fixed';
                    textArea.style.opacity = '0';
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    showToast('ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.', 'success', 'Î≥µÏÇ¨ ÏôÑÎ£å');
                } catch (fallbackError) {
                    showToast('Î≥µÏÇ¨ Í∏∞Îä•ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error', 'Î≥µÏÇ¨ Ïã§Ìå®');
                }
            }
        }

        function downloadResults() {
            if (!AppState.summaryResult) {
                showToast('Îã§Ïö¥Î°úÎìúÌï† ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.', 'warning', 'Îã§Ïö¥Î°úÎìú Ïã§Ìå®');
                return;
            }

            try {
                const blob = new Blob([AppState.summaryResult], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');

                const fileName = AppState.currentFile ?
                    `${AppState.currentFile.name.replace('.pdf', '')}_ÏöîÏïΩ_${new Date().toISOString().slice(0, 10)}.txt` :
                    `PDF_ÏöîÏïΩ_${new Date().toISOString().slice(0, 10)}.txt`;

                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                showToast('ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÌÖçÏä§Ìä∏ ÌååÏùºÎ°ú Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.', 'success', 'Îã§Ïö¥Î°úÎìú ÏôÑÎ£å');
            } catch (error) {
                showToast('ÌååÏùº Îã§Ïö¥Î°úÎìú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error', 'Îã§Ïö¥Î°úÎìú Ïã§Ìå®');
            }
        }

        async function shareResults() {
            if (!AppState.summaryResult) {
                showToast('Í≥µÏú†Ìï† ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.', 'warning', 'Í≥µÏú† Ïã§Ìå®');
                return;
            }

            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'PDF Î¨∏ÏÑú ÏöîÏïΩ Í≤∞Í≥º',
                        text: AppState.summaryResult
                    });
                    showToast('ÏöîÏïΩ Í≤∞Í≥ºÍ∞Ä Í≥µÏú†ÎêòÏóàÏäµÎãàÎã§.', 'success', 'Í≥µÏú† ÏôÑÎ£å');
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        showToast('Í≥µÏú† Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error', 'Í≥µÏú† Ïã§Ìå®');
                    }
                }
            } else {
                // Fallback: copy to clipboard
                await copyResults();
                showToast('Í≥µÏú† Í∏∞Îä•Ïù¥ ÏßÄÏõêÎêòÏßÄ ÏïäÏïÑ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÌñàÏäµÎãàÎã§.', 'warning', 'ÎåÄÏ≤¥ ÎèôÏûë');
            }
        }

        function resetApp() {
            // Reset all state
            AppState.currentFile = null;
            AppState.summaryResult = '';
            AppState.isProcessing = false;

            // Reset UI elements
            document.getElementById('file-input').value = '';
            document.getElementById('file-info').classList.remove('show');
            document.getElementById('progress-container').classList.remove('show');
            document.getElementById('results-section').classList.remove('show');

            // Reset options to default (normal)
            document.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
                card.setAttribute('aria-checked', 'false');
            });
            document.querySelector('[data-mode="normal"]').classList.add('selected');
            document.querySelector('[data-mode="normal"]').setAttribute('aria-checked', 'true');
            AppState.currentSummaryMode = 'normal';

            // Reset button
            disableProcessButton();

            // Scroll to top smoothly
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });

            showToast('ÏÉàÎ°úÏö¥ Î¨∏ÏÑú ÏöîÏïΩÏùÑ ÏãúÏûëÌï† Ï§ÄÎπÑÍ∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.', 'success', 'Ï¥àÍ∏∞Ìôî ÏôÑÎ£å');
        }

        // Toast notification system
        function showToast(message, type = 'success', title = null) {
            const toastContainer = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const toastId = 'toast-' + Date.now();

            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };

            const titles = {
                success: title || 'ÏÑ±Í≥µ',
                error: title || 'Ïò§Î•ò',
                warning: title || 'ÏïåÎ¶º',
                info: title || 'Ï†ïÎ≥¥'
            };

            toast.id = toastId;
            toast.className = `toast ${type}`;
            toast.setAttribute('role', 'alert');
            toast.innerHTML = `
                <div class="toast-icon">${icons[type] || icons.info}</div>
                <div class="toast-content">
                    <div class="toast-title">${titles[type]}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="removeToast('${toastId}')" aria-label="ÏïåÎ¶º Îã´Í∏∞">‚úï</button>
            `;

            toastContainer.appendChild(toast);

            // Show toast with animation
            requestAnimationFrame(() => {
                toast.classList.add('show');
            });

            // Auto remove after 5 seconds
            setTimeout(() => {
                removeToast(toastId);
            }, 5000);
        }

        function removeToast(toastId) {
            const toast = document.getElementById(toastId);
            if (toast) {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }
        }

        // Keyboard navigation for option cards
        function initKeyboardNavigation() {
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter' || event.key === ' ') {
                        event.preventDefault();
                        const mode = card.getAttribute('data-mode');
                        selectOption(mode);
                    }
                });
            });
        }

        // Initialize app
        function initializeApp() {
            initTheme();
            initKeyboardNavigation();
            updateFileSizeDisplay();

            // Prevent default drag behaviors on document
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                }, false);
            });

            // Add skip link for accessibility
            addSkipLink();

            // Handle system theme changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('pdf-summary-theme')) {
                    if (e.matches) {
                        document.body.setAttribute('data-theme', 'dark');
                        document.getElementById('theme-icon').textContent = '‚òÄÔ∏è';
                        AppState.theme = 'dark';
                    } else {
                        document.body.removeAttribute('data-theme');
                        document.getElementById('theme-icon').textContent = 'üåô';
                        AppState.theme = 'light';
                    }
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', (event) => {
                if (event.ctrlKey || event.metaKey) {
                    switch (event.key) {
                        case 'u':
                            event.preventDefault();
                            document.getElementById('file-input').click();
                            break;
                        case 'Enter':
                            event.preventDefault();
                            if (AppState.currentFile && !AppState.isProcessing) {
                                startSummary();
                            }
                            break;
                        case 'r':
                            event.preventDefault();
                            resetApp();
                            break;
                    }
                }
            });

            // Show welcome message
            setTimeout(() => {
                showToast('PDF Î¨∏ÏÑú ÏöîÏïΩ ÏÑúÎπÑÏä§Ïóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§! ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌïòÏó¨ ÏãúÏûëÌïòÏÑ∏Ïöî.', 'info', 'ÌôòÏòÅÌï©ÎãàÎã§');
            }, 1000);
        }

        // Update file size display
        function updateFileSizeDisplay() {
            const fileSizeElement = document.getElementById('max-file-size');
            if (fileSizeElement) {
                fileSizeElement.textContent = formatFileSize(AppState.maxFileSize);
            }
        }

        // Add skip link for accessibility
        function addSkipLink() {
            const skipLink = document.createElement('a');
            skipLink.href = '#main-content';
            skipLink.textContent = 'Î©îÏù∏ ÏΩòÌÖêÏ∏†Î°ú Í±¥ÎÑàÎõ∞Í∏∞';
            skipLink.className = 'sr-only';
            skipLink.style.cssText = `
                position: absolute;
                top: -40px;
                left: 6px;
                background: var(--primary-color);
                color: white;
                padding: 8px;
                border-radius: 4px;
                text-decoration: none;
                z-index: 1000;
                transition: top 0.3s;
            `;

            skipLink.addEventListener('focus', () => {
                skipLink.style.top = '6px';
            });

            skipLink.addEventListener('blur', () => {
                skipLink.style.top = '-40px';
            });

            document.body.insertBefore(skipLink, document.body.firstChild);

            // Add main content ID
            const container = document.querySelector('.container');
            if (container && !container.id) {
                container.id = 'main-content';
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initializeApp);

        // Service Worker registration for PWA capabilities (optional future enhancement)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // navigator.serviceWorker.register('/sw.js');
            });
        }
    </script>
</body>
</html>